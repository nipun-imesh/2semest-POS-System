 <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Management Dashboard</title>
    <link rel="stylesheet" href="style/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- <link rel="stylesheet" href="./node_modules/@fortawesome/fontawesome-free/css/all.min.css"> -->

 
</head>
<body>
    <div class="dashboard">
        <!-- Top Navigation Bar -->
        <div class="navbar">
            <!-- Empty navbar for branding or future use -->
        </div>
        <div class="nav-menu-container">
            <ul class="nav-menu">
                <li><button class="nav-button" data-section="customer-section"><i class="fas fa-user"></i> Customer Management</button></li>
                <li><button class="nav-button" data-section="item-section"><i class="fas fa-box"></i> Item Management</button></li>
                <li><button class="nav-button" data-section="order-section"><i class="fas fa-shopping-cart"></i> Order Management</button></li>
                <li><button class="nav-button" data-section="order-details-section"><i class="fas fa-list"></i> Order Details</button></li>
            </ul>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Customer Section -->
            <div id="customer-section" class="section active">
                <h3>Customer Management</h3>
                <form id="customer-form" class="form-grid">
                    <div class="form-group">
                        <label for="customer-id">Customer ID</label>
                        <input type="text" id="customer-id" placeholder="C001">
                    </div>
                    <div class="form-group">
                        <label for="customer-name">Name</label>
                        <input type="text" id="customer-name" placeholder="nipun">
                    </div>
                    <div class="form-group">
                        <label for="customer-address">Address</label>
                        <input type="text" id="customer-address" placeholder="Address">
                    </div>
                    <div class="form-group">
                        <label for="customer-phone">Phone</label>
                        <input type="text" id="customer-phone" placeholder="07.......">
                    </div>
                  
                </form>
                <div class="button-group">
                    <button type="button" id="save-customer">Save</button>
                    <button type="button" id="update-customer" disabled>Update</button>
                    <button type="button" id="clear-customer" disabled>Clear</button>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Name</th>
                            <th>Address</th>
                            <th>Phone</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="customer-table"></tbody>
                </table>
            </div>

            <!-- Item Section -->
            <div id="item-section" class="section">
                <h3>Item Management</h3>
                <form id="item-form" class="form-grid">
                    <div class="form-group">
                        <label for="item-id">Item ID</label>
                        <input type="text" id="item-id" placeholder="I001">
                    </div>
                    <div class="form-group">
                        <label for="item-name">Description</label>
                        <input type="text" id="item-name" placeholder="I-name">
                    </div>
                    <div class="form-group">
                        <label for="item-price">Unit Price</label>
                        <input type="number" id="item-price" placeholder="999.99">
                    </div>
                    <div class="form-group">
                        <label for="item-quantity">Quantity</label>
                        <input type="number" id="item-quantity" placeholder="10">
                    </div>
                
                </form>
                <div class="button-group">
                    <button type="button" id="save-item">Save</button>
                    <button type="button" id="update-item" disabled>Update</button>
                    <button type="button" id="clear-item" disabled>Clear</button>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Description</th>
                            <th>Unit Price</th>
                            <th>Quantity</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="item-table"></tbody>
                </table>
            </div>

            <!-- Order Section -->
            <div id="order-section" class="section">
                <h3>Order Management</h3>
                <form id="order-form" class="form-grid">
                    <div class="form-group">
                        <label for="order-id">Order ID</label>
                        <input type="text" id="order-id" placeholder="O001">
                    </div>
                    <div class="form-group">
                        <label for="order-customer-id">Customer ID</label>
                        <select id="order-customer-id">
                            <option value="">Select Customer</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="order-customer-name">Customer Name</label>
                        <input type="text" id="order-customer-name" readonly>
                    </div>
                    <div class="form-group">
                        <label for="order-date">Date</label>
                        <input type="date" id="order-date">
                    </div>
                    <div class="form-group">
                        <label for="order-item-id">Item ID</label>
                        <select id="order-item-id">
                            <option value="">Select Item</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="order-item-description">Description</label>
                        <input type="text" id="order-item-description" readonly>
                    </div>
                    <div class="form-group">
                        <label for="order-item-unit-price">Unit Price</label>
                        <input type="number" id="order-item-unit-price" readonly>
                    </div>
                    <div class="form-group">
                        <label for="order-item-available-qty">Available Quantity</label>
                        <input type="number" id="order-item-available-qty" readonly>
                    </div>
                    <div class="form-group">
                        <label for="order-item-qty">Order Quantity</label>
                        <input type="number" id="order-item-qty" placeholder="Enter quantity">
                    </div>
                    <div class="button-group">
                        <button type="button" id="add-to-cart">Add to Cart</button>
                    </div>
                </form>
                <h3>Order Summary</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Item ID</th>
                            <th>Description</th>
                            <th>Unit Price</th>
                            <th>Quantity</th>
                            <th>Total</th>
                        </tr>
                    </thead>
                    <tbody id="order-summary-table"></tbody>
                </table>
                <div class="form-group">
                    <label for="order-total">Total</label>
                    <input type="number" id="order-total" readonly>
                </div>
                <div class="button-group">
                    <button type="button" id="save-order">Save Order</button>
                    <button type="button" id="update-order" disabled>Update</button>
                    <button type="button" id="delete-order" disabled>Delete</button>
                </div>
            </div>

            <!-- Order Details Section -->
            <div id="order-details-section" class="section">
                <h3>Order Details</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Order ID</th>
                            <th>Customer ID</th>
                            <th>Item ID</th>
                            <th>Description</th>
                            <th>Quantity</th>
                            <th>Total</th>
                        </tr>
                    </thead>
                    <tbody id="order-details-table"></tbody>
                </table>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script type="module" src="controller/CustomerController.js"></script>
    <script type="module" src="controller/ItemController.js"></script>
    <script type="module" src="controller/NaveBarController.js"></script>
    <script type="module" src="controller/OrderController.js"></script>
    <script type="module" src="controller/OrderDetailsController.js"></script>
    
    <!-- <script>
    

        

        // Navigation Logic
        $(document).ready(function () {
            // Show Customer section by default
            $("#customer-section").addClass("active");

            // Handle navigation clicks
            $(".nav-button").on("click", function () {
                const sectionId = $(this).data("section");
                $(".section").removeClass("active");
                $(`#${sectionId}`).addClass("active");
                if (sectionId === "order-section") {
                    populateCustomerDropdown();
                    populateItemDropdown();
                }
                if (sectionId === "order-details-section") {
                    loadorderdetails();
                }
            });

            // Initialize disabled buttons
            $("#update-customer, #delete-customer").attr("disabled", "true");
            $("#update-item, #delete-item").attr("disabled", "true");
            $("#update-order, #delete-order").attr("disabled", "true");

            // Populate dropdowns on load
            populateCustomerDropdown();
            populateItemDropdown();
        });

        // Populate Customer Dropdown
        function populateCustomerDropdown() {
            $("#order-customer-id").empty();
            $("#order-customer-id").append('<option value="">Select Customer</option>');
            customer_db.forEach(customer => {
                $("#order-customer-id").append(`<option value="${customer.id}">${customer.id} - ${customer.name}</option>`);
            });
        }

        // Populate Item Dropdown
        function populateItemDropdown() {
            $("#order-item-id").empty();
            $("#order-item-id").append('<option value="">Select Item</option>');
            item_db.forEach(item => {
                $("#order-item-id").append(`<option value="${item.id}">${item.id} - ${item.name}</option>`);
            });
        }

        // Auto-populate Customer Name
        $("#order-customer-id").on("change", function () {
            let customerId = $(this).val();
            let customer = customer_db.find(c => c.id === customerId);
            $("#order-customer-name").val(customer ? customer.name : "");
        });

        // Auto-populate Item Details
        $("#order-item-id").on("change", function () {
            let itemId = $(this).val();
            let item = item_db.find(i => i.id === itemId);
            if (item) {
                $("#order-item-description").val(item.name);
                $("#order-item-unit-price").val(item.price);
                $("#order-item-available-qty").val(item.quantity);
                $("#order-item-qty").val("");
            } else {
                $("#order-item-description").val("");
                $("#order-item-unit-price").val("");
                $("#order-item-available-qty").val("");
                $("#order-item-qty").val("");
           }
        });

        // Add to Cart
        $("#add-to-cart").on("click", function () {
            let itemId = $("#order-item-id").val();
            let description = $("#order-item-description").val();
            let unitPrice = parseFloat($("#order-item-unit-price").val());
            let availableQty = parseInt($("#order-item-available-qty").val());
            let qty = parseInt($("#order-item-qty").val());

            if (!itemId || !description || isNaN(unitPrice) || isNaN(qty) || qty <= 0 || qty > availableQty) {
                Swal.fire({
                    title: "Error!",
                    text: "Please select an item and enter a valid quantity (1 to available quantity).",
                    icon: "error",
                    confirmButtonText: "Ok",
                });
                return;
            }

            // Add to cart
            cart.push({ itemId, description, unitPrice, qty, total: unitPrice * qty });
            updateOrderSummaryTable();
            updateOrderTotal();

            // Clear item fields
            $("#order-item-id").val("");
            $("#order-item-description").val("");
            $("#order-item-unit-price").val("");
            $("#order-item-available-qty").val("");
            $("#order-item-qty").val("");
        });

        // Update Order Summary Table
        function updateOrderSummaryTable() {
            $("#order-summary-table").empty();
            cart.forEach(item => {
                let row = `<tr>
                    <td>${item.itemId}</td>
                    <td>${item.description}</td>
                    <td>${item.unitPrice.toFixed(2)}</td>
                    <td>${item.qty}</td>
                    <td>${item.total.toFixed(2)}</td>
                </tr>`;
                $("#order-summary-table").append(row);
            });
        }

        // Update Order Total
        function updateOrderTotal() {
            let total = cart.reduce((sum, item) => sum + item.total, 0);
            $("#order-total").val(total.toFixed(2));
        }

        // Customer Management
        $("#save-customer").on("click", function () {
            let id = $("#customer-id").val();
            let name = $("#customer-name").val();
            let address = $("#customer-address").val();
            let phone = $("#customer-phone").val();

            if (id === "" || name === "" || address === "" || phone === "") {
                Swal.fire({
                    title: "Error!",
                    text: "Invalid Inputs",
                    icon: "error",
                    confirmButtonText: "Ok",
                });
            } else {
                let customer = new customerModel(id, name, address, phone);
                customer_db.push(customer);
                console.log(customer_db);

                Swal.fire({
                    title: "Added Successfully!",
                    icon: "success",
                    draggable: true,
                });

                loadcustomers();
                populateCustomerDropdown();
            }

            $("#customer-id").val("");
            $("#customer-name").val("");
            $("#customer-address").val("");
            $("#customer-phone").val("");
        });

        function loadcustomers() {
            $("#customer-table").empty();

            customer_db.forEach((item, index) => {
                let row = `<tr>
                    <td>${item.id}</td>
                    <td>${item.name}</td>
                    <td>${item.address}</td>
                    <td>${item.phone}</td>
                    <td>
                        <button class="action-btn delete-btn" onclick="deleteCustomer('${item.id}')">Delete</button>
                    </td>
                </tr>`;
                $("#customer-table").append(row);
            });
        }

        window.editCustomer = function (index) {
            let obj = customer_db[index];
            $("#customer-id").val(obj.id);
            $("#customer-name").val(obj.name);
            $("#customer-address").val(obj.address);
            $("#customer-phone").val(obj.phone);
            $("#update-customer").removeAttr("disabled");
            $("#delete-customer").removeAttr("disabled");
        };

        window.deleteCustomer = function (id) {
            let index = customer_db.findIndex(customer => customer.id === id);
            if (index !== -1) {
                customer_db.splice(index, 1);
                Swal.fire({
                    title: "Deleted Successfully!",
                    icon: "success",
                    draggable: true,
                });
                loadcustomers();
                populateCustomerDropdown();
            } else {
                Swal.fire({
                    title: "Error!",
                    text: "Customer not found",
                    icon: "error",
                    confirmButtonText: "Ok",
                });
            }
            $("#customer-id").val("");
            $("#customer-name").val("");
            $("#customer-address").val("");
            $("#customer-phone").val("");
            $("#update-customer").attr("disabled", "true");
            $("#delete-customer").attr("disabled", "true");
        };

        $("#customer-table").on('click', 'tr', function () {
            let idx = $(this).index();
            editCustomer(idx);
        });

        $("#update-customer").on("click", function () {
            let id = $("#customer-id").val();
            let name = $("#customer-name").val();
            let address = $("#customer-address").val();
            let phone = $("#customer-phone").val();

            if (id === "" || name === "" || address === "" || phone === "") {
                Swal.fire({
                    title: "Error!",
                    text: "Invalid Inputs",
                    icon: "error",
                    confirmButtonText: "Ok",
                });
            } else {
                let index = customer_db.findIndex(customer => customer.id === id);
                if (index !== -1) {
                    customer_db[index] = new customerModel(id, name, address, phone);
                    Swal.fire({
                        title: "Updated Successfully!",
                        icon: "success",
                        draggable: true,
                    });
                    loadcustomers();
                    populateCustomerDropdown();
                } else {
                    Swal.fire({
                        title: "Error!",
                        text: "Customer not found",
                        icon: "error",
                        confirmButtonText: "Ok",
                    });
                }
            }

            $("#customer-id").val("");
            $("#customer-name").val("");
            $("#customer-address").val("");
            $("#customer-phone").val("");
            $("#update-customer").attr("disabled", "true");
            $("#delete-customer").attr("disabled", "true");
        });

        $("#delete-customer").on("click", function () {
            let id = $("#customer-id").val();
            deleteCustomer(id);
        });

        // Item Management
        $("#save-item").on("click", function () {
            let id = $("#item-id").val();
            let name = $("#item-name").val();
            let price = $("#item-price").val();
            let quantity = $("#item-quantity").val();

            if (id === "" || name === "" || price === "" || quantity === "") {
                Swal.fire({
                    title: "Error!",
                    text: "Invalid Inputs",
                    icon: "error",
                    confirmButtonText: "Ok",
                });
            } else {
                let item = new itemModel(id, name, price, quantity);
                item_db.push(item);
                Swal.fire({
                    title: "Added Successfully!",
                    icon: "success",
                    draggable: true,
                });
                loaditem();
                populateItemDropdown();
            }

            $("#item-id").val("");
            $("#item-name").val("");
            $("#item-price").val("");
            $("#item-quantity").val("");
        });

        function loaditem() {
            $("#item-table").empty();

            item_db.forEach((item, index) => {
                let row = `<tr>
                    <td>${item.id}</td>
                    <td>${item.name}</td>
                    <td>${item.price}</td>
                    <td>${item.quantity}</td>
                    <td>
                        <button class="action-btn delete-btn" onclick="deleteItem('${item.id}')">Delete</button>
                    </td>
                </tr>`;
                $("#item-table").append(row);
            });
        }

        window.editItem = function (index) {
            let obj = item_db[index];
            $("#item-id").val(obj.id);
            $("#item-name").val(obj.name);
            $("#item-price").val(obj.price);
            $("#item-quantity").val(obj.quantity);
            $("#update-item").removeAttr("disabled");
            $("#delete-item").removeAttr("disabled");
        };

        window.deleteItem = function (id) {
            let index = item_db.findIndex(item => item.id === id);
            if (index !== -1) {
                item_db.splice(index, 1);
                Swal.fire({
                    title: "Deleted Successfully!",
                    icon: "success",
                    draggable: true,
                });
                loaditem();
                populateItemDropdown();
            } else {
                Swal.fire({
                    title: "Error!",
                    text: "Item not found",
                    icon: "error",
                    confirmButtonText: "Ok",
                });
            }
            $("#item-id").val("");
            $("#item-name").val("");
            $("#item-price").val("");
            $("#item-quantity").val("");
            $("#update-item").attr("disabled", "true");
            $("#delete-item").attr("disabled", "true");
        };

        $("#item-table").on('click', 'tr', function () {
            let idx = $(this).index();
            editItem(idx);
        });

        $("#update-item").on("click", function () {
            let id = $("#item-id").val();
            let name = $("#item-name").val();
            let price = $("#item-price").val();
            let quantity = $("#item-quantity").val();

            if (id === "" || name === "" || price === "" || quantity === "") {
                Swal.fire({
                    title: "Error!",
                    text: "Invalid Inputs",
                    icon: "error",
                    confirmButtonText: "Ok",
                });
            } else {
                let index = item_db.findIndex(item => item.id === id);
                if (index !== -1) {
                    item_db[index] = new itemModel(id, name, price, quantity);
                    Swal.fire({
                        title: "Updated Successfully!",
                        icon: "success",
                        draggable: true,
                    });
                    loaditem();
                    populateItemDropdown();
                } else {
                    Swal.fire({
                        title: "Error!",
                        text: "Item not found",
                        icon: "error",
                        confirmButtonText: "Ok",
                    });
                }
            }

            $("#item-id").val("");
            $("#item-name").val("");
            $("#item-price").val("");
            $("#item-quantity").val("");
            $("#update-item").attr("disabled", "true");
            $("#delete-item").attr("disabled", "true");
        });

        $("#delete-item").on("click", function () {
            let id = $("#item-id").val();
            deleteItem(id);
        });

        // Order Management
        $("#save-order").on("click", function () {
            let id = $("#order-id").val();
            let customerId = $("#order-customer-id").val();
            let date = $("#order-date").val();
            let total = parseFloat($("#order-total").val());

            if (id === "" || customerId === "" || date === "" || isNaN(total) || cart.length === 0) {
                Swal.fire({
                    title: "Error!",
                    text: "Please fill all fields and add items to the cart.",
                    icon: "error",
                    confirmButtonText: "Ok",
                });
                return;
            }

            // Save order
            let order = new orderModel(id, customerId, date, total);
            order_db.push(order);

            // Save order details
            cart.forEach(item => {
                let orderDetails = new orderDetailsModel(id, item.itemId, item.qty, item.unitPrice);
                orderDetails_db.push(orderDetails);
            });

            Swal.fire({
                title: "Order Saved Successfully!",
                icon: "success",
                draggable: true,
            });

            // Clear form and cart
            $("#order-id").val("");
            $("#order-customer-id").val("");
            $("#order-customer-name").val("");
            $("#order-date").val("");
            $("#order-total").val("");
            cart = [];
            updateOrderSummaryTable();
            loadorders();
        });

        function loadorders() {
            $("#order-table").empty();

            order_db.forEach((order, index) => {
                let row = `<tr>
                    <td>${order.id}</td>
                    <td>${order.customerId}</td>
                    <td>${order.date}</td>
                    <td>${order.total}</td>
                </tr>`;
                $("#order-table").append(row);
            });
        }

        $("#order-table").on('click', 'tr', function () {
            let idx = $(this).index();
            let obj = order_db[idx];

            $("#order-id").val(obj.id);
            $("#order-customer-id").val(obj.customerId);
            $("#order-customer-name").val(customer_db.find(c => c.id === obj.customerId)?.name || "");
            $("#order-date").val(obj.date);
            $("#order-total").val(obj.total);

            // Load cart from orderDetails_db
            cart = orderDetails_db
                .filter(details => details.orderId === obj.id)
                .map(details => ({
                    itemId: details.itemId,
                    description: item_db.find(i => i.id === details.itemId)?.name || "",
                    unitPrice: details.unitPrice,
                    qty: details.quantity,
                    total: details.quantity * details.unitPrice
                }));
            updateOrderSummaryTable();

            $("#update-order").removeAttr("disabled");
            $("#delete-order").removeAttr("disabled");
        });

        $("#update-order").on("click", function () {
            let id = $("#order-id").val();
            let customerId = $("#order-customer-id").val();
            let date = $("#order-date").val();
            let total = parseFloat($("#order-total").val());

            if (id === "" || customerId === "" || date === "" || isNaN(total) || cart.length === 0) {
                Swal.fire({
                    title: "Error!",
                    text: "Please fill all fields and add items to the cart.",
                    icon: "error",
                    confirmButtonText: "Ok",
                });
                return;
            }

            // Update order
            let index = order_db.findIndex(order => order.id === id);
            if (index !== -1) {
                order_db[index] = new orderModel(id, customerId, date, total);

                // Remove old order details
                orderDetails_db = orderDetails_db.filter(details => details.orderId !== id);

                // Add new order details
                cart.forEach(item => {
                    let orderDetails = new orderDetailsModel(id, item.itemId, item.qty, item.unitPrice);
                    orderDetails_db.push(orderDetails);
                });

                Swal.fire({
                    title: "Updated Successfully!",
                    icon: "success",
                    draggable: true,
                });

                loadorders();
            } else {
                Swal.fire({
                    title: "Error!",
                    text: "Order not found",
                    icon: "error",
                    confirmButtonText: "Ok",
                });
            }

            // Clear form and cart
            $("#order-id").val("");
            $("#order-customer-id").val("");
            $("#order-customer-name").val("");
            $("#order-date").val("");
            $("#order-total").val("");
            cart = [];
            updateOrderSummaryTable();
            $("#update-order").attr("disabled", "true");
            $("#delete-order").attr("disabled", "true");
        });

        $("#delete-order").on("click", function () {
            let id = $("#order-id").val();

            let index = order_db.findIndex(order => order.id === id);
            if (index !== -1) {
                order_db.splice(index, 1);
                orderDetails_db = orderDetails_db.filter(details => details.orderId !== id);
                Swal.fire({
                    title: "Deleted Successfully!",
                    icon: "success",
                    draggable: true,
                });

                loadorders();
            } else {
                Swal.fire({
                    title: "Error!",
                    text: "Order not found",
                    icon: "error",
                    confirmButtonText: "Ok",
                });
            }

            $("#order-id").val("");
            $("#order-customer-id").val("");
            $("#order-customer-name").val("");
            $("#order-date").val("");
            $("#order-total").val("");
            cart = [];
            updateOrderSummaryTable();
            $("#update-order").attr("disabled", "true");
            $("#delete-order").attr("disabled", "true");
        });

        // Order Details Management
        function loadorderdetails() {
            $("#order-details-table").empty();

            orderDetails_db.forEach(details => {
                let item = item_db.find(i => i.id === details.itemId);
                let total = details.quantity * details.unitPrice;
                let row = `<tr>
                    <td>${details.orderId}</td>
                    <td>${order_db.find(o => o.id === details.orderId)?.customerId || ""}</td>
                    <td>${details.itemId}</td>
                    <td>${item ? item.name : ""}</td>
                    <td>${details.quantity}</td>
                    <td>${total.toFixed(2)}</td>
                </tr>`;
                $("#order-details-table").append(row);
            });
        }
    </script> -->
</body>
</html> 


